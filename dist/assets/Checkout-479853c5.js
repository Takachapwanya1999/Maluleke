import{i as z,o as U,r as m,j as e,N as X,p as _,L as b,k as ee,q as Z,s as B,a as v,t as Y}from"./index-dde97d41.js";const ae=()=>{var D,q,F,E,L,M,O,$,A,I,R,T;const{state:h,clearCart:G}=z(),{state:i}=U(),[l,j]=m.useState(1),[f,K]=m.useState(!1),[N,w]=m.useState(!1),[x,u]=m.useState(null),[a,C]=m.useState({firstName:((D=i.user)==null?void 0:D.firstName)||"",lastName:((q=i.user)==null?void 0:q.lastName)||"",email:((F=i.user)==null?void 0:F.email)||"",phone:((E=i.user)==null?void 0:E.phone)||"",address:{street:((M=(L=i.user)==null?void 0:L.address)==null?void 0:M.street)||"",city:(($=(O=i.user)==null?void 0:O.address)==null?void 0:$.city)||"",province:((I=(A=i.user)==null?void 0:A.address)==null?void 0:I.province)||"",postalCode:((T=(R=i.user)==null?void 0:R.address)==null?void 0:T.postalCode)||""}}),[c,k]=m.useState("card"),[r,V]=m.useState({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""});if(h.items.length===0&&!f)return e.jsx(X,{to:"/cart",replace:!0});const o=s=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(s),d=(s,t)=>{if(s.includes(".")){const[n,Q]=s.split(".");C(W=>({...W,[n]:{...W[n]||{},[Q]:t}}))}else C(n=>({...n,[s]:t}))},H=async()=>{w(!0),u(null);try{if(await new Promise(s=>setTimeout(s,2e3)),c==="card"){if(!r.cardNumber||!r.expiryDate||!r.cvv||!r.cardholderName)throw new Error("Please complete all card details");if(r.cardNumber.replace(/\s/g,"").length<16)throw new Error("Invalid card number");if(Math.random()<.1)throw new Error("Payment declined. Please try again or use a different payment method.")}K(!0),G(),i.user&&console.log("Order added to user history")}catch(s){u(s instanceof Error?s.message:"Payment failed")}finally{w(!1)}},p=(s,t)=>{V(n=>({...n,[s]:t})),x&&u(null)},y=s=>{switch(s){case 1:return!!(a.firstName&&a.lastName&&a.email&&a.phone&&a.address.street&&a.address.city&&a.address.province&&a.address.postalCode);case 2:return c==="card"?!!(r.cardNumber&&r.expiryDate&&r.cvv&&r.cardholderName):!0;default:return!0}},P=s=>{y(l)&&(j(s),u(null))};if(f)return e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"h-8 w-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Order Placed Successfully!"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Thank you for your order. We'll send you a confirmation email shortly."}),e.jsxs("div",{className:"space-y-4 sm:space-y-0 sm:space-x-4 sm:flex sm:justify-center",children:[e.jsx(b,{to:"/products",className:"btn-primary",children:"Continue Shopping"}),e.jsx(b,{to:"/",className:"btn-outline",children:"Return Home"})]})]})});const g=h.total,S=g*.15,J=g+S;return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Checkout"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Complete your order in just a few steps"})]}),e.jsxs(b,{to:"/cart",className:"inline-flex items-center text-primary-600 hover:text-primary-700",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Back to Cart"]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:`flex items-center space-x-2 ${l>=1?"text-primary-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l>=1?"bg-primary-600 text-white":"bg-gray-200"}`,children:"1"}),e.jsx("span",{className:"font-medium",children:"Shipping"})]}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsxs("div",{className:`flex items-center space-x-2 ${l>=2?"text-primary-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l>=2?"bg-primary-600 text-white":"bg-gray-200"}`,children:"2"}),e.jsx("span",{className:"font-medium",children:"Payment"})]}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsxs("div",{className:`flex items-center space-x-2 ${l>=3?"text-primary-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l>=3?"bg-primary-600 text-white":"bg-gray-200"}`,children:"3"}),e.jsx("span",{className:"font-medium",children:"Review"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[l===1&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Shipping Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:a.firstName,onChange:s=>d("firstName",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:a.lastName,onChange:s=>d("lastName",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>d("email",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:a.phone,onChange:s=>d("phone",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),e.jsx("input",{type:"text",value:a.address.street,onChange:s=>d("address.street",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),e.jsx("input",{type:"text",value:a.address.city,onChange:s=>d("address.city",s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Province *"}),e.jsxs("select",{value:a.address.province,onChange:s=>d("address.province",s.target.value),className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Select Province"}),e.jsx("option",{value:"Gauteng",children:"Gauteng"}),e.jsx("option",{value:"Western Cape",children:"Western Cape"}),e.jsx("option",{value:"KwaZulu-Natal",children:"KwaZulu-Natal"}),e.jsx("option",{value:"Eastern Cape",children:"Eastern Cape"}),e.jsx("option",{value:"Free State",children:"Free State"}),e.jsx("option",{value:"Limpopo",children:"Limpopo"}),e.jsx("option",{value:"Mpumalanga",children:"Mpumalanga"}),e.jsx("option",{value:"Northern Cape",children:"Northern Cape"}),e.jsx("option",{value:"North West",children:"North West"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code *"}),e.jsx("input",{type:"text",value:a.address.postalCode,onChange:s=>d("address.postalCode",s.target.value),className:"input-field",required:!0})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>P(2),className:"btn-primary",disabled:!y(1),children:"Continue to Payment"})})]}),l===2&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Payment Method"}),x&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("p",{className:"text-red-700",children:x})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",id:"card",name:"payment",value:"card",checked:c==="card",onChange:s=>k(s.target.value),className:"w-4 h-4 text-primary-600"}),e.jsxs("label",{htmlFor:"card",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{children:"Credit/Debit Card"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",id:"cash",name:"payment",value:"cash",checked:c==="cash",onChange:s=>k(s.target.value),className:"w-4 h-4 text-primary-600"}),e.jsxs("label",{htmlFor:"cash",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:"Cash on Delivery"})]})]})]}),c==="card"&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"Your payment information is secure and encrypted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cardholder Name *"}),e.jsx("input",{type:"text",value:r.cardholderName,onChange:s=>p("cardholderName",s.target.value),placeholder:"John Doe",className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Number *"}),e.jsx("input",{type:"text",value:r.cardNumber,onChange:s=>{const t=s.target.value.replace(/\D/g,"").replace(/(\d{4})(?=\d)/g,"$1 ");t.length<=19&&p("cardNumber",t)},placeholder:"1234 5678 9012 3456",className:"input-field",maxLength:19,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"text",value:r.expiryDate,onChange:s=>{const t=s.target.value.replace(/\D/g,"");if(t.length<=4){const n=t.length>=2?`${t.slice(0,2)}/${t.slice(2,4)}`:t;p("expiryDate",n)}},placeholder:"MM/YY",className:"input-field",maxLength:5,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV *"}),e.jsx("input",{type:"text",value:r.cvv,onChange:s=>{const t=s.target.value.replace(/\D/g,"");t.length<=3&&p("cvv",t)},placeholder:"123",className:"input-field",maxLength:3,required:!0})]})]})]}),c==="cash"&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(v,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Cash on Delivery"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Pay with cash when your order is delivered. Please have the exact amount ready."})]})]})}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:()=>j(1),className:"btn-outline",children:"Back"}),e.jsx("button",{onClick:()=>P(3),className:"btn-primary",disabled:!y(2),children:"Review Order"})]})]}),l===3&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Order Review"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Shipping Address"}),e.jsxs("p",{className:"text-gray-600",children:[a.firstName," ",a.lastName,e.jsx("br",{}),a.address.street,e.jsx("br",{}),a.address.city,", ",a.address.province," ",a.address.postalCode,e.jsx("br",{}),a.phone]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Payment Method"}),e.jsx("div",{className:"flex items-center space-x-2",children:c==="card"?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"text-gray-600",children:["Credit/Debit Card ending in ",r.cardNumber.slice(-4)||"****"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-gray-600",children:"Cash on Delivery"})]})})]}),x&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("p",{className:"text-red-700",children:x})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Order Items"}),e.jsx("div",{className:"space-y-3",children:h.items.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.product.image,alt:s.product.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.product.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",s.quantity]})]})]}),e.jsx("p",{className:"font-medium text-gray-900",children:o(s.product.price*s.quantity)})]},s.product.id))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>j(2),className:"btn-outline",disabled:N,children:"Back"}),e.jsx("button",{onClick:H,className:"btn-primary",disabled:N,children:N?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Processing Payment..."})]}):"Place Order"})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-2 mb-4",children:h.items.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[s.product.name," × ",s.quantity]}),e.jsx("span",{className:"font-medium",children:o(s.product.price*s.quantity)})]},s.product.id))}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsx("span",{className:"font-medium",children:o(g)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsx("span",{className:"font-medium text-green-600",children:"Free"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tax (15%)"}),e.jsx("span",{className:"font-medium",children:o(S)})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:o(J)})]})}),l===3&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:c==="card"?"Secure SSL Payment":"Cash Payment on Delivery"})]})})]})]})})]})]})};export{ae as default};
